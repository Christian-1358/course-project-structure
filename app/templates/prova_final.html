<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Prova Final | Certifica√ß√£o Master em Milhas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
:root {
    --gold: linear-gradient(135deg, #d4af37 0%, #f1d592 50%, #d4af37 100%);
    --bg: #0a0a0a;
    --card-bg: #141414;
    --border: #2a2a2a;
    --text-main: #ffffff;
    --text-dim: #a0a0a0;
    --correct: #10b981;
    --wrong: #ef4444;
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

* { box-sizing: border-box; }

body {
    background: var(--bg);
    color: var(--text-main);
    font-family: 'Inter', sans-serif;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
}

.prova-container {
    width: 95%;
    max-width: 650px;
    background: var(--card-bg);
    padding: 40px;
    border-radius: 24px;
    border: 1px solid var(--border);
    box-shadow: 0 20px 50px rgba(0,0,0,0.4);
    position: relative;
}

.btn-debug {
    position: absolute;
    top: 10px;
    right: 10px;
    background: #333;
    color: #666;
    border: none;
    font-size: 10px;
    padding: 5px 10px;
    border-radius: 5px;
    cursor: pointer;
    opacity: 0.3;
}
.btn-debug:hover { opacity: 1; background: #444; }

.progress-container {
    width: 100%;
    height: 6px;
    background: #222;
    border-radius: 10px;
    margin-bottom: 30px;
}

.progress-bar {
    height: 100%;
    background: var(--gold);
    width: 0%;
    border-radius: 10px;
    transition: var(--transition);
}

h2 {
    text-align: center;
    background: var(--gold);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: 800;
    margin-bottom: 5px;
}

.subtitle {
    text-align: center;
    color: var(--text-dim);
    font-size: 0.9rem;
    margin-bottom: 30px;
}

.questao { display: none; }
.questao.active { display: block; animation: slideIn 0.4s ease-out; }

@keyframes slideIn {
    from { opacity: 0; transform: translateX(20px); }
    to { opacity: 1; transform: translateX(0); }
}

h4 { font-size: 1.1rem; margin-bottom: 20px; line-height: 1.5; color: #f1d592; }

.opcao {
    padding: 16px;
    border-radius: 12px;
    background: #1e1e1e;
    border: 1px solid var(--border);
    cursor: pointer;
    margin-bottom: 10px;
    transition: var(--transition);
    font-size: 0.95rem;
}

.opcao:hover {
    border-color: #d4af37;
    background: #252525;
}

.opcao.correct {
    border-color: var(--correct);
    background: rgba(16,185,129,0.1);
    color: var(--correct);
}

.opcao.wrong {
    border-color: var(--wrong);
    background: rgba(239,68,68,0.1);
    color: var(--wrong);
}

.btn-action {
    width: 100%;
    margin-top: 20px;
    padding: 18px;
    background: var(--gold);
    color: #000;
    border: none;
    border-radius: 14px;
    font-weight: 700;
    cursor: pointer;
    display: none;
}

#resultado { display: none; text-align: center; }

.score-circle {
    width: 120px;
    height: 120px;
    border: 4px solid #d4af37;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 20px;
    font-size: 2rem;
    font-weight: 800;
    color: #d4af37;
}

#btnCertificado {
    background: var(--gold);
    color: #000;
    text-decoration: none;
    display: none;
    padding: 18px;
    border-radius: 14px;
    font-weight: 700;
    margin-top: 20px;
    width: 100%;
}
</style>
</head>

<body>

<div class="prova-container">
    <button class="btn-debug" onclick="pularParaFinal()">MODO TESTE</button>

    <div class="progress-container">
        <div class="progress-bar" id="progress"></div>
    </div>

    <h2>EXAME DE CERTIFICA√á√ÉO</h2>
    <p class="subtitle">N√≠vel Especialista: Voc√™ precisa de 80% de acerto (40/50)</p>

    <div id="quiz"></div>

    <button class="btn-action" id="nextBtn">Pr√≥xima Quest√£o</button>

    <div id="resultado">
        <div class="score-circle" id="score"></div>
        <p><strong id="statusFinal">ANALISANDO RESULTADO...</strong></p>
        
        <div id="listaBeneficios" class="cert-list" style="display:none; margin: 20px 0; font-size: 0.9rem; color: #bbb;">
            ‚úî Registro de Especialista em Milhas<br>
            ‚úî Dom√≠nio de Emiss√µes Internacionais<br>
            ‚úî Estrategista de Cashback e Pontos<br>
            ‚úî Operador Profissional de Arbitragem
        </div>

        <a href="/gerar_certificado_final" id="btnCertificado">EMITIR CERTIFICADO OFICIAL</a>
        <p id="msgReprovado" style="display:none; color: var(--wrong); margin-top: 20px;">
            Infelizmente voc√™ n√£o atingiu a nota m√≠nima. Estude os m√≥dulos novamente e tente em 24h.
        </p>
    </div>
</div>

<script>
const NOTA_MINIMA = 40;
let atual = 0;
let acertos = 0;

const perguntas = [
    // --- FUNDAMENTOS E CPM ---
    ["No c√°lculo de CPM, se voc√™ compra 100k pontos por R$ 3.500 e recebe 100% de b√¥nus, qual o seu CPM real?", ["R$ 35,00", "R$ 17,50", "R$ 70,00", "R$ 21,00"], 1],
    ["Qual a diferen√ßa t√©cnica entre Pontos e Milhas?", ["Nenhuma, s√£o sin√¥nimos", "Pontos s√£o de bancos, milhas de companhias a√©reas", "Pontos nunca expiram, milhas sim", "Milhas valem mais que pontos"], 1],
    ["Ao analisar um milheiro (1.000 milhas), o que define se a emiss√£o √© vantajosa?", ["O valor total das taxas", "O CPM da milha vs o valor da passagem em dinheiro", "A quantidade de conex√µes", "O modelo da aeronave"], 1],
    ["O 'Spread' banc√°rio em compras internacionais incide sobre:", ["Apenas o IOF", "A cota√ß√£o do d√≥lar oficial (PTAX)", "O limite do cart√£o", "A anuidade"], 1],
    ["Qual o risco principal de manter milhas paradas na conta por muito tempo?", ["Taxa de cust√≥dia", "Desvaloriza√ß√£o inflacion√°ria (tabelas sobem)", "Bloqueio do CPF", "Perda de benef√≠cios do cart√£o"], 1],

    // --- CART√ïES E BENEF√çCIOS ---
    ["O benef√≠cio 'Prote√ß√£o de Pre√ßo' da Visa √© v√°lido para qual categoria?", ["Apenas Infinite", "Apenas Platinum", "Gold e Platinum", "Todas as categorias"], 2],
    ["O que caracteriza um cart√£o de cr√©dito como 'Co-branded'?", ["Cart√£o que n√£o cobra anuidade", "Parceria entre banco e uma marca (ex: Azul Ita√∫)", "Cart√£o que aceita qualquer bandeira", "Cart√£o exclusivo para PJ"], 1],
    ["O acesso √†s Salas VIP via 'LoungeKey' √© sempre gratuito?", ["Sim, para qualquer cart√£o Black", "N√£o, depende da pol√≠tica espec√≠fica do banco emissor", "Sim, apenas no exterior", "Sim, se o cart√£o for Infinite"], 1],
    ["A regra de 'Giro de Carteira' serve para:", ["Aumentar o score de cr√©dito", "Gerar pontos com gastos org√¢nicos", "Evitar o bloqueio do cart√£o por inatividade", "Isentar a anuidade por m√©dia de gastos"], 3],
    ["Qual bandeira √© conhecida pelo benef√≠cio 'Pague 1 Leve 2' em cinemas e parceiros no Brasil?", ["Visa", "Mastercard (Surpreenda)", "Elo", "Amex"], 1],

    // --- AC√öMULO ESTRAT√âGICO ---
    ["Em uma promo√ß√£o de 'Compra Bonificada' de 10 pontos por Real, o que √© essencial verificar no regulamento?", ["A cor do produto", "Se o b√¥nus √© apenas para produtos vendidos e entregues pelo parceiro", "O limite de parcelas", "O nome do entregador"], 1],
    ["Qual o objetivo de assinar um Clube de Pontos (ex: Clube Livelo)?", ["Apenas ganhar pontos extras", "Garantir acesso a promo√ß√µes de transfer√™ncia com b√¥nus maior", "Ter desconto na fatura", "Poder sacar dinheiro no caixa"], 1],
    ["Ao transferir pontos para a Smiles com 100% de b√¥nus, meus 50k pontos Livelo viram quanto no destino?", ["50.000 milhas", "150.000 milhas", "100.000 milhas", "75.000 milhas"], 2],
    ["O que significa 'Stacking' no mundo das milhas?", ["Cancelar v√°rios cart√µes de uma vez", "Empilhar promo√ß√µes (ex: Cupom + Compra Bonificada + Cart√£o)", "Usar apenas um cart√£o para tudo", "Vender milhas para v√°rias empresas"], 1],
    ["Postos de combust√≠vel (Ipiranga/Shell) s√£o boas fontes de ac√∫mulo quando:", ["O pre√ßo do combust√≠vel √© o mais caro", "H√° promo√ß√µes de transfer√™ncia bonificada para cias a√©reas", "Voc√™ paga com dinheiro f√≠sico", "Sempre, independente da taxa de transfer√™ncia"], 1],

    // --- EMISS√ïES E TABELAS ---
    ["O que √© uma 'Tabela Fixa' em programas de fidelidade?", ["Um valor que nunca muda, independente da data", "O pre√ßo da anuidade do cart√£o", "A taxa de embarque fixa", "O valor do d√≥lar no dia"], 0],
    ["Qual programa √© famoso por permitir emiss√µes com parceiros mundiais usando Tabela Fixa?", ["Smiles", "TudoAzul", "Interline (Iberia/TAP)", "Livelo"], 2],
    ["O termo 'Stopover' permite que o passageiro:", ["Cancele a viagem sem custos", "Fique alguns dias em uma cidade de conex√£o sem pagar a mais", "Leve bagagem extra gr√°tis", "Troque de classe no port√£o de embarque"], 1],
    ["O que √© a 'Tarifa Award'?", ["Passagem comprada com dinheiro", "Emiss√£o com milhas em assentos espec√≠ficos disponibilizados pela cia", "Taxa paga para entrar na sala VIP", "Premia√ß√£o de funcion√°rio do m√™s"], 1],
    ["Ao emitir para os EUA com milhas, qual taxa costuma ser a mais agressiva em certas cias europeias?", ["Taxa de embarque", "Taxa de combust√≠vel (YQ)", "Taxa de emiss√£o", "IOF"], 1],

    // --- REGRAS E SEGURAN√áA ---
    ["A 'Regra dos 25 CPFs' na Smiles limita o qu√™?", ["O n√∫mero de milhas que voc√™ pode ter", "A quantidade de pessoas diferentes para quem voc√™ pode emitir passagens", "O n√∫mero de cart√µes cadastrados", "As transfer√™ncias do banco"], 1],
    ["O que pode causar o 'Shadow Ban' ou bloqueio de conta em programas de pontos?", ["Comprar passagens demais", "Uso excessivo de ferramentas de automa√ß√£o e rob√¥s", "Esquecer a senha", "Ter dois cart√µes de bancos diferentes"], 1],
    ["O 'Upgrade de Cabine' com milhas √© garantido?", ["Sim, se voc√™ tiver as milhas", "N√£o, depende de disponibilidade e classe tarif√°ria original", "Sim, se o voo for internacional", "Apenas para quem tem cart√£o Black"], 1],
    ["Qual a validade padr√£o de pontos transferidos em promo√ß√µes bonificadas (geralmente)?", ["Vital√≠cios", "6 meses a 2 anos", "10 anos", "1 m√™s"], 1],
    ["O programa ALL Accor √© focado em qual tipo de ac√∫mulo/resgate?", ["Passagens a√©reas", "Hospedagens e experi√™ncias em hot√©is", "Aluguel de carros", "Cruzeiros"], 1],

    // --- INTERMEDI√ÅRIO/AVAN√áADO ---
    ["A estrat√©gia de 'Carrinho de Compras' na Livelo serve para:", ["Comprar produtos mais baratos", "Comprar milhas com desconto indireto em transfer√™ncias", "Organizar a lista de desejos", "Evitar pagar anuidade"], 1],
    ["Qual o impacto do 'D√≥lar Cart√£o' no ac√∫mulo de pontos?", ["Nenhum, pontos s√£o por Real", "Geralmente √© maior que o comercial, encarecendo o ponto", "√â menor que o oficial, ajudando o viajante", "Define o valor da milha Smiles"], 1],
    ["O 'Seguro Prote√ß√£o de Compra' protege contra:", ["Arrependimento da compra", "Roubo ou dano acidental em at√© 45-90 dias", "Aumento de pre√ßo no m√™s seguinte", "Atraso na entrega"], 1],
    ["Emiss√µes 'Open Jaw' s√£o aquelas onde:", ["O passageiro volta de um aeroporto diferente do que chegou", "O passageiro viaja com a boca aberta", "O voo n√£o tem conex√µes", "A passagem √© s√≥ de ida"], 0],
    ["Qual a principal vantagem da 'Tabela Interline' da TudoAzul?", ["Voar apenas dentro do Brasil", "Emitir passagens em cias parceiras (ex: TAP, United) com pontos Azul", "Ganhar cashback na fatura", "Isen√ß√£o total de taxas de embarque"], 1],

    // --- CEN√ÅRIOS PR√ÅTICOS (QUEST√ïES 31-50) ---
    ["Se uma passagem custa R$ 2.000 ou 100k milhas, e seu CPM √© R$ 15,00. O que √© melhor?", ["Pagar em dinheiro", "Usar milhas (Custo real R$ 1.500)", "N√£o viajar", "Esperar o pre√ßo baixar"], 1],
    ["Para quem busca Classe Executiva para Europa, qual programa costuma ter o melhor custo-benef√≠cio via parceiros?", ["TAP Miles&Go", "Smiles", "Latam Pass", "Livelo Shop"], 0],
    ["O 'Acompanhante Gr√°tis' (Companion Pass) √© um benef√≠cio de qual cart√£o no Brasil?", ["Santander Unlimited", "Azul Ita√∫ Visa Infinite", "Bradesco Prime", "Inter Black"], 1],
    ["O que acontece se voc√™ transferir pontos de uma conta CPF 'A' para uma conta de milhas CPF 'B'?", ["Os pontos dobram", "A transa√ß√£o √© bloqueada ou cobrada como transfer√™ncia entre contas", "Os pontos chegam normalmente sem custo", "O cart√£o √© cancelado"], 1],
    ["Qual a melhor √©poca para vender milhas nas plataformas?", ["Janeiro (baixa procura)", "Meses antes de per√≠odos de alta temporada (f√©rias/feriados)", "Qualquer dia, o pre√ßo √© fixo", "Quando o d√≥lar cai"], 1],
    ["A estrat√©gia de 'Pagar Boletos com Cart√£o' ainda √© amplamente vantajosa?", ["Sim, sempre", "N√£o, as taxas dos apps costumam ser maiores que o valor dos pontos gerados", "Sim, apenas para boletos de impostos", "Sim, se o boleto for acima de 10k"], 1],
    ["Qual categoria na Latam Pass oferece o benef√≠cio de 'Cupons de Upgrade'?", ["Todas", "Apenas categorias Elite (Gold, Platinum, Black)", "Nenhuma, upgrade √© s√≥ com milhas", "Apenas para quem paga anuidade"], 1],
    ["O 'Certificado de Operador de Milhas' permite:", ["Trabalhar na Receita Federal", "Executar estrat√©gias avan√ßadas de ac√∫mulo e emiss√£o com seguran√ßa", "Viajar sem passaporte", "Ter limite infinito"], 1],
    ["O benef√≠cio 'Atraso de Bagagem' dos cart√µes Visa/Mastercard garante:", ["Uma mala nova", "Reembolso para despesas essenciais durante o atraso", "Milhas em dobro no voo", "Upgrade para executiva"], 1],
    ["O que √© o 'Status Match'?", ["Quando dois programas de milhas se fundem", "Quando uma cia a√©rea reconhece seu n√≠vel elite de outra cia parceira", "Quando o pre√ßo da milha iguala ao do banco", "Um tipo de seguro viagem"], 1],
    ["A 'Taxa de Emiss√£o' em voos com milhas √© obrigat√≥ria em:", ["Qualquer voo", "Varia conforme o programa e o canal (online vs call center)", "Nunca √© cobrada", "Apenas para beb√™s"], 1],
    ["O programa 'Esfera' pertence a qual banco?", ["Bradesco", "Santander", "Ita√∫", "Banco do Brasil"], 1],
    ["A Smiles pertence a qual grupo?", ["Latam", "GOL", "Azul", "TAP"], 1],
    ["Para voar com a Qatar Airways (eleita melhor do mundo), qual milha brasileira √© mais f√°cil de usar?", ["Azul", "Latam Pass ou Smiles (via parceiros)", "Livelo", "Esfera"], 1],
    ["O limite de '5 benefici√°rios' na Latam Pass reinicia quando?", ["Todo dia 1¬∫", "A cada 12 meses ap√≥s a primeira emiss√£o", "Nunca, √© pra sempre", "Quando voc√™ cancela o cart√£o"], 1],
    ["O ac√∫mulo 'Org√¢nico' √© aquele que vem de:", ["Compras de pontos", "Gastos do dia a dia no cart√£o de cr√©dito", "Transfer√™ncias bonificadas", "B√¥nus de assinatura"], 1],
    ["Qual ferramenta √© essencial para buscar disponibilidade em Tabela Fixa?", ["Calculadora do celular", "Sites das pr√≥prias cias ou ferramentas de busca de alian√ßa (ex: ExpertFlyer)", "Instagram de milhas", "Chat do banco"], 1],
    ["O 'Valor de Mercado' da milha Smiles hoje gira em torno de:", ["R$ 70,00", "R$ 14,00 a R$ 18,00", "R$ 35,00", "R$ 5,00"], 1],
    ["Ao assinar o Clube Livelo 20.000, o foco principal √©:", ["Gastar os pontos na loja Livelo", "Gerar estoque de pontos para transfer√™ncias estrat√©gicas", "Ganhar cashback", "Isentar o cart√£o de cr√©dito"], 1],
    ["A mentalidade do 'Mestre das Milhas' foca em:", ["Gastar o m√°ximo poss√≠vel", "Transformar gastos obrigat√≥rios em viagens e lucro atrav√©s de estrat√©gia", "Ter o maior n√∫mero de cart√µes", "Vender milhas para amigos"], 1]
];

const quiz = document.getElementById("quiz");
const nextBtn = document.getElementById("nextBtn");
const progress = document.getElementById("progress");

function renderQuestao() {
    quiz.innerHTML = "";
    const q = perguntas[atual];
    const div = document.createElement("div");
    div.className = "questao active";
    div.innerHTML = `<h4>${atual + 1}. ${q[0]}</h4>`;

    q[1].forEach((op, i) => {
        const opcao = document.createElement("div");
        opcao.className = "opcao";
        opcao.textContent = op;
        opcao.onclick = () => selecionar(opcao, i, q[2]);
        div.appendChild(opcao);
    });

    quiz.appendChild(div);
    progress.style.width = (atual / perguntas.length) * 100 + "%";
}

function selecionar(el, i, correta) {
    const opcoes = document.querySelectorAll(".opcao");
    opcoes.forEach(o => o.onclick = null);

    if (i === correta) {
        el.classList.add("correct");
        acertos++;
    } else {
        el.classList.add("wrong");
        opcoes[correta].classList.add("correct");
    }
    nextBtn.style.display = "block";
}

nextBtn.onclick = () => {
    atual++;
    nextBtn.style.display = "none";
    if (atual < perguntas.length) {
        renderQuestao();
    } else {
        finalizar();
    }
};

function finalizar() {
    quiz.style.display = "none";
    document.getElementById("resultado").style.display = "block";
    document.getElementById("score").textContent = `${acertos}/${perguntas.length}`;
    progress.style.width = "100%";

    if (acertos >= NOTA_MINIMA) {
        document.getElementById("statusFinal").textContent = "üöÄ PARAB√âNS, ESPECIALISTA!";
        document.getElementById("listaBeneficios").style.display = "block";

        // envia resultado para o servidor para registrar aprova√ß√£o e gerar certificado
        const form = new URLSearchParams();
        form.append('acertos', acertos);
        form.append('total', perguntas.length);

        fetch('/prova/final', { method: 'POST', body: form })
            .then(r => r.text())
            .then(txt => {
                // redireciona para certificado final caso backend confirme
                window.location.href = '/certificado/6';
            }).catch(e => {
                console.error('Erro ao enviar nota final', e);
                document.getElementById("btnCertificado").style.display = "block";
            });

    } else {
        document.getElementById("statusFinal").textContent = "‚ùå REPROVADO";
        document.getElementById("msgReprovado").style.display = "block";
    }
}

function pularParaFinal() {
    atual = 49;
    acertos = 42;
    renderQuestao();
}

renderQuestao();
</script>
</body>
</html>