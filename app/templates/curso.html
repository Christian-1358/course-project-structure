<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mestre das Milhas | Plataforma de Certifica√ß√£o</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0a0b0d; --panel: #161b22; --sidebar: #0d1117; --text: #e6edf3;
            --text-muted: #8b949e; --accent: #a855f7; --border: #30363d; --success: #238636;
        }
        * { box-sizing: border-box; transition: all 0.2s ease; }
        body { margin: 0; font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        header { height: 60px; display: flex; align-items: center; justify-content: space-between; padding: 0 24px; background: var(--sidebar); border-bottom: 1px solid var(--border); z-index: 100; }
        .logo { font-weight: 800; font-size: 1.1rem; }
        .logo span { color: var(--accent); }

        main { display: flex; flex: 1; overflow: hidden; position: relative; }
        .content-area { flex: 1; overflow-y: auto; background: var(--bg); }
        .video-container { width: 100%; background: #000; aspect-ratio: 16/9; position: relative; }
        .video-container iframe { width: 100%; height: 100%; border: none; }
        
        .toggle-sidebar-btn { position: absolute; right: 0; top: 50%; transform: translateY(-50%); background: var(--accent); color: white; border: none; padding: 15px 8px; cursor: pointer; border-radius: 8px 0 0 8px; z-index: 50; }

        .lesson-body { padding: 30px 40px; max-width: 1000px; }
        .nav-controls { display: flex; align-items: center; gap: 15px; margin: 25px 0; }
        
        /* SIDEBAR */
        .sidebar { width: 380px; background: var(--sidebar); border-left: 1px solid var(--border); display: flex; flex-direction: column; }
        .sidebar.closed { width: 0; overflow: hidden; border-left: none; }
        .modules-wrapper { flex: 1; overflow-y: auto; }
        .module-item { border-bottom: 1px solid var(--border); }
        .module-btn { width: 100%; padding: 16px 20px; background: var(--panel); border: none; color: var(--text); display: flex; justify-content: space-between; cursor: pointer; font-size: 14px; font-weight: 600; text-align: left; }
        .lessons-list { display: none; }
        .module-item.open .lessons-list { display: block; }

        .lesson-item { padding: 15px 20px; display: flex; gap: 12px; cursor: pointer; font-size: 13px; border-bottom: 1px solid var(--border); align-items: center; }
        .lesson-item.active { background: #21262d; border-left: 4px solid var(--accent); }
        .lesson-item.completed span { color: var(--text-muted); text-decoration: line-through; }
        .lesson-item.is-quiz { background: rgba(168, 85, 247, 0.05); color: var(--accent); font-weight: 700; border-top: 1px solid var(--border); }

        .final-exam-area { padding: 20px; background: var(--panel); border-top: 2px solid var(--accent); }

        button { padding: 10px 18px; border-radius: 6px; cursor: pointer; border: 1px solid var(--border); background: var(--panel); color: var(--text); font-weight: 600; }
        .btn-accent { background: var(--accent); color: white; border: none; }
    </style>
</head>
<body>

<header>
    <div class="logo">‚úàÔ∏è MESTRE DAS <span>MILHAS</span></div>
    <div id="prog-txt" style="font-size: 12px; background: var(--panel); padding: 5px 15px; border-radius: 20px; border: 1px solid var(--border);">0% Conclu√≠do</div>
</header>

<main>
    <div class="content-area">
        <div class="video-container">
<iframe id="mainPlayer" src=""></iframe>
            <button class="toggle-sidebar-btn" onclick="toggleSidebar()">‚ùÆ</button>
        </div>
        
        <div class="lesson-body">
            <h2 id="currentTitle">...</h2>
            <div class="nav-controls">
                <button onclick="changeLesson(-1)" style="margin-left:auto">Anterior</button>
                <button class="btn-accent" onclick="changeLesson(1)">Pr√≥xima Aula</button>
            </div>
            <div id="currentDesc" style="color: var(--text-muted); line-height: 1.8; margin-top: 20px; background: var(--panel); padding: 20px; border-radius: 8px; border: 1px solid var(--border);"></div>
        </div>
    </div>

    <div class="sidebar" id="sidebar">
        <div class="modules-wrapper" id="moduleContainer"></div>
        <div class="final-exam-area">
            <button class="btn-accent" style="width:100%" onclick="window.location.href='Atividade_Final.html'" id="finalBtn" disabled>üéì ATIVIDADE FINAL (BLOQUEADA)</button>
        </div>
    </div>
</main>

<script>
    const course = [
        { name: "1. Fundamentos e CPM", lessons: [
            {t: "Vis√£o Geral 2026", d: "Entenda o mercado atual e como se posicionar para lucrar.", v: "3r6Q9tCzX4k"},
            {t: "Dicion√°rio do Milheiro", d: "Termos t√©cnicos essenciais para n√£o ficar perdido.", v: "8pTEmbeENF4"},
            {t: "C√°lculo de CPM", d: "A matem√°tica que define se voc√™ tem lucro ou preju√≠zo.", v: "Z9z8Z2f3nGQ"},
            {t: "Livelo e Esfera", d: "Os dois pilares do ac√∫mulo banc√°rio no Brasil.", v: "yJz8QyYw7l8"},
            {t: "Cias A√©reas", d: "Diferen√ßas entre Smiles, Latam Pass e TudoAzul.", v: "p7HKvqRI_Bo"},
            {t: "Alertas T√©cnicos", d: "Configurando ferramentas de monitoramento em tempo real.", v: "dZ9gY8JwqfE"},
            {t: "Primeiro Ac√∫mulo", d: "Passo a passo pr√°tico para gerar suas primeiras milhas.", v: "5Y3G6a2Z8sU"}
        ], id: 0 },

        { name: "2. Cart√µes e Benef√≠cios", lessons: [
            {t: "Ranking de Cart√µes", d: "Quais cart√µes realmente valem a pena manter em 2026.", v: "Qv2L8g1m3kM"},
            {t: "Zerar Anuidade", d: "Scripts de negocia√ß√£o para n√£o pagar taxas banc√°rias.", v: "7J9x8w3QX2M"},
            {t: "Salas VIP", d: "LoungeKey, DragonPass e Priority Pass na pr√°tica.", v: "1b9QX5M0H8I"},
            {t: "Seguros Gratuitos", d: "Economize com seguros de viagem inclusos no cart√£o.", v: "L8z1p9Y0QH4"},
            {t: "Cooperativas", d: "O poder do Sicredi e Unicred no mundo das milhas.", v: "C8QZ3y9mF4s"},
            {t: "Upgrade de Limite", d: "Como for√ßar o banco a te dar um cart√£o Black/Infinite.", v: "9X3ZLkQ8P2s"},
            {t: "Spread Zero", d: "Como economizar em todas as compras internacionais.", v: "M8LZ9Q2KX1A"},
            {t: "Prote√ß√£o de Pre√ßo", d: "Receba dinheiro de volta se o pre√ßo do produto baixar.", v: "wZ8L9Ck3m0E"}
        ], id: 1},

        { name: "3. Ac√∫mulo Estrat√©gico", lessons: [
            {t: "Compras 10x1", d: "Como ganhar 10 pontos por real em compras comuns.", v: "P9Zk3L8QX4s"},
            {t: "Compra de Pontos", d: "Quando vale a pena comprar pontos diretamente no banco.", v: "Q9ZL2X8M3F4"},
            {t: "B√¥nus de 100%", d: "A hora certa de transferir seus pontos para as a√©reas.", v: "dZ9gY8JwqfE"},
            {t: "Clubes de Milhas", d: "An√°lise de ROI: Quais clubes assinar e quais cancelar.", v: "3r6Q9tCzX4k"},
            {t: "Milhas no Tanque", d: "Estrat√©gias para Shell Box e postos Ipiranga.", v: "8pTEmbeENF4"},
            {t: "Parceiros Varejo", d: "Amazon, Magalu e Casas Bahia como fontes de pontos.", v: "Z9z8Z2f3nGQ"},
            {t: "Gest√£o de CPFs", d: "Como escalar o ac√∫mulo usando contas de terceiros.", v: "yJz8QyYw7l8"},
            {t: "Datas Sazonais", d: "Aproveitando Black Friday e anivers√°rios de programas.", v: "p7HKvqRI_Bo"},
            {t: "Giro de Boletos", d: "Pagando contas e ganhando pontos simultaneamente.", v: "dZ9gY8JwqfE"}
        ], id: 2 },

        { name: "4. Emiss√µes Internacionais", lessons: [
            {t: "Tabela Fixa", d: "O segredo para passagens baratas independente da data.", v: "5Y3G6a2Z8sU"},
            {t: "Classe Executiva", d: "Como voar com luxo pagando pre√ßo de econ√¥mica.", v: "Qv2L8g1m3kM"},
            {t: "Stopover", d: "Adicionando destinos extras sem custo na passagem.", v: "7J9x8w3QX2M"},
            {t: "Iberia Plus", d: "A melhor forma de chegar √† Europa com milhas.", v: "1b9QX5M0H8I"},
            {t: "Regras de CPF", d: "Limites de emiss√£o para n√£o ser bloqueado nas cias.", v: "L8z1p9Y0QH4"},
            {t: "Destinos EUA", d: "Melhores rotas para Miami e NY com milhas Smiles.", v: "C8QZ3y9mF4s"},
            {t: "Taxas de Combust√≠vel", d: "Como identificar e evitar cobran√ßas abusivas.", v: "9X3ZLkQ8P2s"},
            {t: "ALL Accor", d: "Hospedagem de luxo utilizando seus pontos.", v: "M8LZ9Q2KX1A"}
        ], id: 3},

        { name: "5. Milhas como Neg√≥cio", lessons: [
            {t: "Venda em Balc√£o", d: "Operando via Maxmilhas e Hotmilhas com seguran√ßa.", v: "wZ8L9Ck3m0E"},
            {t: "Venda Particular", d: "Captando clientes e aumentando sua margem de lucro.", v: "P9Zk3L8QX4s"},
            {t: "Gest√£o de Lucro", d: "Planilhas profissionais para controle de estoque de milhas.", v: "Q9ZL2X8M3F4"},
            {t: "Imposto de Renda", d: "Como declarar seus ganhos de forma legal.", v: "dZ9gY8JwqfE"},
            {t: "Ag√™ncia Digital", d: "Estruturando sua pr√≥pria emissora de passagens.", v: "3r6Q9tCzX4k"},
            {t: "Reinvestimento", d: "Como fazer as milhas pagarem suas pr√≥prias faturas.", v: "8pTEmbeENF4"},
            {t: "Tend√™ncias 2026", d: "O que esperar do mercado nos pr√≥ximos meses.", v: "Z9z8Z2f3nGQ"},
            {t: "Mentoria Final", d: "D√∫vidas finais e encerramento da jornada.", v: "yJz8QyYw7l8"}
        ], id: 4 }
    ];


let current = { m: 0, l: 0 };

let progress = JSON.parse(localStorage.getItem('mm_progress')) || {
    lessons: {},   // { videoId: true }
    exams: {},     // { moduleIndex: true }
    final: false
};

/* =========================
   INICIALIZA√á√ÉO
========================= */

function init() {
    const container = document.getElementById('moduleContainer');
    container.innerHTML = "";

    course.forEach((mod, mIdx) => {
        const div = document.createElement('div');
        div.className = `module-item ${mIdx === 0 ? 'open' : ''}`;

        const lessonsHTML = mod.lessons.map((les, lIdx) => `
            <div class="lesson-item ${progress.lessons[les.v] ? 'completed' : ''}"
                 id="les-${les.v}"
                 onclick="play(${mIdx}, ${lIdx})">
                 
                <input type="checkbox"
                    ${progress.lessons[les.v] ? 'checked' : ''}
                    onclick="event.stopPropagation(); toggleLesson('${les.v}')">
                    
                <span>${lIdx + 1}. ${les.t}</span>
            </div>
        `).join('');

        div.innerHTML = `
            <button class="module-btn" onclick="this.parentElement.classList.toggle('open')">
                ${mod.name}
                <span>‚ñº</span>
            </button>

            <div class="lessons-list">
                ${lessonsHTML}
                <div class="lesson-item is-quiz" onclick="openExamFile(${mIdx})">
                    <span> PROVA DO M√ìDULO</span>
                </div>
            </div>
        `;

        container.appendChild(div);
    });

    play(0, 0);
    updateProgressUI();
}

/* =========================
   PLAYER / NAVEGA√á√ÉO
========================= */

function play(m, l) {
    current = { m, l };
    const lesson = course[m].lessons[l];

    document.getElementById('mainPlayer').src =
        `https://www.youtube.com/embed/${lesson.v}?autoplay=1`;

    document.getElementById('currentTitle').innerText = lesson.t;
    document.getElementById('currentDesc').innerText = lesson.d;

    document.querySelectorAll('.lesson-item')
        .forEach(e => e.classList.remove('active'));

    const active = document.getElementById(`les-${lesson.v}`);
    if (active) active.classList.add('active');
}

function changeLesson(step) {
    const next = current.l + step;
    if (course[current.m].lessons[next]) {
        play(current.m, next);
    }
}

/* =========================
   CONTROLE DE PROGRESSO
========================= */

function toggleLesson(videoId) {
    progress.lessons[videoId] = !progress.lessons[videoId];
    saveProgress();
    updateLessonUI(videoId);
    updateProgressUI();
}

function updateLessonUI(videoId) {
    const el = document.getElementById(`les-${videoId}`);
    if (!el) return;
    el.classList.toggle('completed');
}

function updateProgressUI() {
    const total = course.reduce((acc, m) => acc + m.lessons.length, 0);
    const done = Object.keys(progress.lessons).filter(k => progress.lessons[k]).length;
    const percent = Math.round((done / total) * 100);

    document.getElementById('prog-txt').innerText = `${percent}% Conclu√≠do`;

    const btnFinal = document.getElementById('finalBtn');

    if (percent === 100) {
        btnFinal.disabled = false;
        btnFinal.innerText = "üöÄ INICIAR ATIVIDADE FINAL";
    } else {
        btnFinal.disabled = true;
        btnFinal.innerText = "üéì ATIVIDADE FINAL (BLOQUEADA)";
    }
}

function saveProgress() {
    localStorage.setItem('mm_progress', JSON.stringify(progress));
}

/* =========================
   PROVAS POR M√ìDULO
========================= */

function openExamFile(mIdx) {
    const mod = course[mIdx];

    // Verifica se todas as li√ß√µes do m√≥dulo foram marcadas como conclu√≠das [cite: 2026-01-20]
    const allLessonsDone = mod.lessons.every(
        l => progress.lessons[l.v]
    );

    if (!allLessonsDone) {
        alert("‚ö†Ô∏è Conclua todas as aulas deste m√≥dulo para liberar a prova.");
        return;
    }

    // O mIdx do primeiro m√≥dulo √© 0. Somamos 1 para virar /prova/1 [cite: 2026-01-20]
    const moduloReal = mIdx + 1;
    
    progress.exams[mIdx] = true;
    saveProgress();

    // Redireciona para o arquivo correto (prova.html, prova2.html, etc) [cite: 2026-01-20]
    window.location.href = `/prova/${moduloReal}`;
}
/* =========================
   ATIVIDADE FINAL
========================= */

function startFinal() {
    const total = course.reduce((a, m) => a + m.lessons.length, 0);
    const done = Object.keys(progress.lessons).filter(k => progress.lessons[k]).length;

    if (done !== total) {
        alert("‚ö†Ô∏è Finalize todas as aulas antes de iniciar a atividade final.");
        return;
    }

    progress.final = true;
    saveProgress();

    window.location.href = "atividade_final.html";
}

/* =========================
   SIDEBAR
========================= */

function toggleSidebar() {
    const sb = document.getElementById('sidebar');
    sb.classList.toggle('closed');
    document.querySelector('.toggle-sidebar-btn').innerText =
        sb.classList.contains('closed') ? '‚ùØ' : '‚ùÆ';
}

/* =========================
   START
========================= */

init();

</script>
</body>
</html>
