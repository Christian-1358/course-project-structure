<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MESTRE DAS MILHAS | Curso</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
    --gold: #d4af37;
    --gold-gradient: linear-gradient(135deg, #d4af37 0%, #f1d592 50%, #b8860b 100%);
    --dark-bg: #020202;
    --dark-card: #0a0a0a;
    --border: rgba(212, 175, 55, 0.15);
    --accent: #00ffa3;
    --text-dim: #a0a0a0;
    --sidebar-width: 280px;
}

/* RESET */
* { margin:0; padding:0; box-sizing:border-box; font-family:'Plus Jakarta Sans', sans-serif; }
body { background:var(--dark-bg); color:#fff; display:flex; min-height:100vh; overflow-x:hidden; scroll-behavior:smooth; }

::-webkit-scrollbar { width:6px; }
::-webkit-scrollbar-track { background:#000; }
::-webkit-scrollbar-thumb { background:var(--gold); border-radius:10px; }

/* SIDEBAR */
nav {
    width:var(--sidebar-width); background:#000; border-right:1px solid var(--border); padding:40px 20px;
    position:fixed; height:100vh; overflow-y:auto; z-index:1000;
}
.logo { font-size:26px; font-weight:900; color:#fff; margin-bottom:50px; text-decoration:none; display:block; }
.logo span { color:var(--gold); }

.nav-group { margin-bottom:30px; }
.nav-label { font-size:11px; color:var(--gold); font-weight:800; text-transform:uppercase; letter-spacing:1.5px; margin-bottom:12px; display:block; opacity:0.8; }
.nav-link { padding:12px 18px; border-radius:12px; display:flex; align-items:center; gap:12px; color:var(--text-dim); font-size:14px; font-weight:500; cursor:pointer; border:1px solid transparent; transition:0.3s; }
.nav-link.active, .nav-link:hover { background:var(--dark-card); color:var(--gold); border-color:var(--border); transform:translateX(5px); }

/* MAIN */
main { flex:1; margin-left:var(--sidebar-width); padding:50px; }
main h1 { margin-bottom:30px; font-size:28px; font-weight:700; color:var(--gold); }

/* CARDS */
.module-card {
    background:var(--dark-card); border:1px solid var(--border); border-radius:20px; display:flex; align-items:center;
    gap:20px; padding:20px; margin-bottom:20px; cursor:pointer; transition:0.3s; flex-wrap:wrap;
}
.module-card:hover { transform:translateY(-5px); border-color:var(--gold); }
.module-card img { width:140px; height:90px; object-fit:cover; border-radius:12px; flex-shrink:0; }
.module-info { flex:1; min-width:180px; }
.module-info h3 { font-size:18px; font-weight:700; margin-bottom:5px; color:#fff; }
.module-info p { font-size:13px; color:var(--text-dim); margin-bottom:10px; }
.btn-card {
    padding:8px 16px; border:none; border-radius:12px; background:var(--gold-gradient); color:#000; font-weight:700;
    cursor:pointer; transition:0.3s;
}
.btn-card:hover { filter:brightness(1.1); }

/* MODAL */
.modal {
    position:fixed; inset:0; background:rgba(0,0,0,0.95); display:none; align-items:center; justify-content:center;
    padding:20px; z-index:2000;
}
.modal-body {
    width:100%; max-width:1100px; background:var(--dark-card); border-radius:32px; display:grid; grid-template-columns:1.7fr 1fr;
    max-height:85vh; overflow:hidden; box-shadow:0 50px 100px rgba(0,0,0,0.9);
}
.v-container { position:relative; width:100%; padding-top:56.25%; background:#000; }
.v-container iframe { position:absolute; top:0; left:0; width:100%; height:100%; border:none; border-radius:12px; }
.v-details { padding:30px; display:flex; flex-direction:column; gap:15px; overflow-y:auto; }
.v-details h2 { margin-bottom:10px; color:var(--gold); }
.v-details p { font-size:13px; color:var(--text-dim); }
.v-details textarea { width:100%; height:100px; background:#050505; border:1px solid #333; border-radius:12px; color:#fff; padding:12px; resize:none; outline:none; transition:0.3s; }
.v-details textarea:focus { border-color:var(--gold); }
.btn-gold {
    background:var(--gold-gradient); color:#000; padding:14px; border-radius:16px; border:none; font-weight:800; cursor:pointer; transition:0.3s;
}
.btn-gold:hover { filter:brightness(1.1); }
.close-modal { background:transparent; color:var(--text-dim); border:none; cursor:pointer; margin-top:10px; font-size:14px; }

@media(max-width:1100px){ .modal-body { grid-template-columns:1fr; } .v-details { border-left:none; border-top:1px solid var(--border); } }
@media(max-width:600px){ main { padding:30px 20px; } .module-card { flex-direction:column; align-items:flex-start; } }
</style>
</head>
<body>

<nav>
<a href="#" class="logo">MILHAS<span>MASTER</span></a>

<div class="nav-group">
<span class="nav-label">Curso</span>
<div class="nav-link active" onclick="showSection('modules')"><i class="fas fa-graduation-cap"></i> Todos os M√≥dulos</div>
</div>
</nav>

<main>
<h1>O que voc√™ vai aprender</h1>
<div id="modules-container"></div>
</main>

<!-- MODAL AULA -->
<div class="modal" id="modal-aula">
<div class="modal-body">
<div class="v-container">
<iframe id="vid-player" src="" allowfullscreen></iframe>
</div>
<div class="v-details">
<h2 id="m-t">T√≠tulo da Aula</h2>
<p id="m-d"></p>
<h4>üìù Atividade</h4>
<textarea id="m-inp" placeholder="Digite sua resposta..."></textarea>
<button class="btn-gold" onclick="finishAula()">SALVAR E CONCLUIR AULA</button>
<button class="close-modal" onclick="closeModal()">Fechar</button>
</div>
</div>
</div>

<script>
// ARMAZENA M√ìDULOS
let modules = [];
let currentModule = null;

// BUSCA M√ìDULOS DO BACKEND TORNADO
async function fetchModules() {
    try {
        const res = await fetch("/api/modules");
        modules = await res.json();
        renderModules();
    } catch (err) {
        console.error("Erro ao carregar m√≥dulos:", err);
    }
}

// RENDERIZA CARDS
function renderModules() {
    const container = document.getElementById("modules-container");
    container.innerHTML = "";
    modules.forEach(m => {
        const div = document.createElement("div");
        div.className = "module-card";
        div.innerHTML = `
            <img src="${m.image}" alt="${m.title}">
            <div class="module-info">
                <h3>${m.title}</h3>
                <p>${m.description}</p>
                <button class="btn-card" onclick="openModuleAula(${m.id})">Ver Aulas & Atividades</button>
            </div>
        `;
        container.appendChild(div);
    });
}

// FUN√á√ÉO √öNICA PARA ABRIR QUALQUER M√ìDULO/AULA
function openModuleAula(moduleId, lessonId = null) {
    const mod = modules.find(m => m.id === moduleId);
    if(!mod) return console.error("M√≥dulo n√£o encontrado:", moduleId);
    
    const aula = lessonId ? mod.lessons.find(l => l.id === lessonId) : mod.lessons[0];
    if(!aula) return console.error("Aula n√£o encontrada:", lessonId);

    document.getElementById("vid-player").src = aula.video;
    document.getElementById("m-t").innerText = aula.title;
    document.getElementById("m-d").innerText = aula.task;
    document.getElementById("m-inp").value = "";
    document.getElementById("modal-aula").style.display = "flex";

    currentModule = aula;
}

// MODAL
function finishAula() {
    alert("Atividade conclu√≠da: " + currentModule.title);
    closeModal();
}
function closeModal() {
    document.getElementById("modal-aula").style.display = "none";
    document.getElementById("vid-player").src = "";
}

// INICIALIZA
fetchModules();
</script>

</body>
</html>
